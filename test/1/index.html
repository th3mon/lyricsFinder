<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>test</title> 
</head>
<body>
    <div id="main">
        <article id="result">
            <header>
                <h2 id="artist"></h2>
                <h2 id="song"></h2>
            </header>
            <div id="content">
                <p id="lyrics"></p>
            </div>
        </article>
    </div>
    <form action="">
        <p><label for="artist">artist: </label><input type="text" name="artist"></p>
        <p><label for="song">song: </label><input type="text" name="song"></p>
        <p>
           <input type="submit">
        </p>
    </form>
    <script src="http://code.jquery.com/jquery-1.10.2.min.js"></script>
    <script src="../../js/requestCrossDomain.js"></script>
    <script>
        var artist = '',
            song = '',
            url = '',
            errors = [],

            parseResult = function(data) {
                var
                    artist = data.artist,
                    song = data.song,
                    lyrics = data.lyrics,
                    url = data.url,

                    $artist = $('#artist'),
                    $song = $('#song'),
                    $lyrics = $('#lyrics');

                console.dir(data);

                lyrics = lyrics.replace(/\n/g, '<br>');
                console.log(lyrics);

                $artist.text(artist);
                $song.text(song);
                $lyrics.html(lyrics);
            },

            parseToUrlSafeValues = function(str) {
                str = encodeURIComponent(str);
                str = str.replace('%2B', '+');

                return str;
            };

        // url = 'http://lyrics.wikia.com/api.php?artist=Queen&song=Bohemian+Rhapsody&fmt=json';
        // http://lyrics.wikia.com/api.php?artist=Queen&song=Bohemian+Rhapsody&fmt=realjson&callback=parseResult
        url = 'http://lyrics.wikia.com/api.php?artist={{artist}}&song={{song}}&fmt=realjson&callback=parseResult';

        $('form').on('submit', function() {
            artist = $('form [name="artist"]').val();
            artist = parseToUrlSafeValues(artist);

            song = $('form [name="song"]').val();
            song = parseToUrlSafeValues(song);

            if (artist && song) {
                url = url.replace('{{artist}}', artist).replace('{{song}}', song);

                $.ajax({
                    url: url,
                    crossDomain: true,
                    dataType: 'jsonp',
                    jsonp: 'parseResult'
                });
            }

            else {
                errors.push('nie podano wszystkich danych');
            }

                // requestCrossDomain(url, function(results) {  
                //    $('#container').html(results);  
                // });

            return false;
        });
    </script>
</body>
</html>